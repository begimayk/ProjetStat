---
title: "Projet Stats"
output:
  html_document: default
  pdf_document: default
date: "2023-05-05"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# Check if the package is installed; if not, install it
if (!require(ggplot2)) {
  install.packages("ggplot2")
  library(ggplot2)
}

```
## Introduction

Les données sont prises de https://www.kaggle.com/ .
Les données concernent les joueuses de volleyball et contiennent des informations sur leur date de naissance, leur taille, leur poids, leur hauteur de saut (spike), leur hauteur de bloc, leur poste de jeu et leur pays d'origine.

La date de naissance, la taille et le poids sont des caractéristiques physiques des joueuses qui peuvent avoir une incidence sur leurs performances. La hauteur de saut (spike) et de bloc sont également des facteurs importants dans le volleyball, car ils mesurent la capacité d'une joueuse à attaquer et à défendre. Le poste de jeu de la joueuse est également une information importante, car chaque poste a des responsabilités et des rôles différents sur le terrain. Enfin, le pays d'origine peut également avoir une incidence sur le style de jeu et le niveau de compétition des joueuses.

En utilisant ces données, il est possible de mener des analyses statistiques pour étudier la relation entre ces caractéristiques et les performances des joueuses sur le terrain, ainsi que pour étudier les différences entre les joueuses de différents pays et postes de jeu. Ces informations peuvent être utiles pour les entraîneurs et les recruteurs pour sélectionner les joueuses les plus adaptées à leur équipe, ainsi que pour les chercheurs qui s'intéressent aux facteurs qui influencent les performances sportives.

## Variables pour l'analyse

Nous allons effectuer une analyse statistique des données fournies, en commençant par comparer les fréquences des nationalités des joueuses. Ensuite, nous étudierons les capacités et aptitudes des joueuses, à savoir la hauteur maximale d'attaque et la hauteur maximale de blocage, en fonction de leur poste. Ces deux variables sont qualitatives.

Pour approfondir cette étude, nous analyserons également les aptitudes des joueuses en fonction de leurs postes. Cette analyse portera sur des variables quantitatives, ce qui nous permettra d'explorer plus en détail les différences et les tendances entre les postes occupés par les joueuses.


## Chargement de données 

```{r}

url <- "women_vb.csv"
data <- read.csv(url,sep=';', header=TRUE)

```


## Analyse univariée sur les pays de naissance des joueuses


Nous allons d'abord analyser les effectifs des pays de naissance des joueuses 
```{r}

pays <- data['pays']

ggplot(data, aes(x = pays)) +
  geom_bar(fill = "skyblue") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  labs(x = "Pays de naissances", y = "Effectifs")

```

#### Quelles conclusions nous pouvons faire?

Sur ce diagramme en batôns nous obsevons que la fréquence de la plupart des pays de naissance des joueuses est égale à 12. Il n'y a que la Japon et Mexique qui sont les pays de naissance de 11 joueuse et la Bulgarie avec le maximum de ce diagramme : 13.

### Un diagramme en camembert des pays de naissance

```{r}

# Calculer les effectifs de chaque pays
pays_eff <- table(pays)

# Calculer les pourcentages the percentages
pays_percentages <- prop.table(pays_eff) * 100

# Create a color palette for the pie slices
pale_colors <- c("#F2B5D4", "#B8E3E6", "#FFDB9A", "#B3D9B2", "#FAC8A7", "#D7D7E0",
                "#F9E6B8", "#B7C9E2", "#F1C2DC", "#C9E8C9", "#FFE4C4", "#D0E0EB")


# Créer le diagramme en camembert
pie(pays_eff, labels = paste(names(pays_eff), "(", sprintf("%.1f%%", pays_percentages), ")"), col = pale_colors)

# Add a legend
legend("topright", legend = names(pays_eff), fill = pale_colors, cex = 0.8)

```
// COMMENTER (pour voir tous les pays)


Pour approfondir cette analyse nous allons étudier les aptitudes des joueuses en fonction de leur pays de naissance:

```{r}
attaque<-data$attaque

ggplot(data, aes(x = pays, y = attaque)) +
  geom_boxplot() +
  labs(title = "Box Plot de la hauteur d'attaque des joueuses en fonction de leur pays de naissance",
       x = "Pays de naissance",
       y = "La hauteur d'attaque") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

Sur cette boîte à moustache nous constatons que le pays avec la plus grande variance des aptitudes des joueuse est le Mexique. On y retrouve également les pays avec la meilleure hauteur d'attaque qui est l'Italie. 
// TODO : commenter le résultat
```{r}
# Calculate variances for 'attaques' by country
variances <- aggregate(attaque ~ pays, data = data, FUN = var)
means <- aggregate(attaque ~ pays, data = data, FUN = mean)
# Print the resulting variances
print(variances)
print(means)
```
// faire analyse des variance et les moyennes 



```{r}
moyenne_attaque <- aggregate(attaque ~ pays, data = data, FUN = mean)

# Sort the countries by mean attack in descending order
moyenne_attaque <- moyenne_attaque[order(-moyenne_attaque$attaque), ]

# Create a bar plot using ggplot
ggplot(moyenne_attaque, aes(x = pays, y = attaque)) +
  geom_bar(stat = "identity", fill = "lightblue") +
  labs(title = "Mean Attack by Country", x = "Country", y = "Mean Attack")
```

Nous avons remarqué grâce à l'analyse ci-dessous, qu'il y avait une donnée erronée dans notre jeu de données puisqu'il y avait une joueuse qui avait une hauteur de block à 0. Nous avons donc fait le choix de retirer cette joueuse du jeu de données.

## Analyse univariée sur la hauteur de block 
```{r}
block <- data$block
moyenne <- mean(block)
print(paste("La hauteur moyenne de block est de", round(moyenne, 2)))
variance <- var(block)
print(paste("La variance de la hauteur de block est de", round(variance, 2)))

# Analyse gaussienne
par(mfrow=c(1,2))
hist(block , main="Répartition de la hauteur de block ",xlab="Hauteur de block (en cm)",prob=T)
curve(dnorm(x, mean(block), sd(block)), col=2, add=TRUE, lty=2)
qqnorm(block)
qqline(block, col=2)

# Calcul de l'intervalle de confiance à 95% pour la moyenne
intervalle_de_confiance <- t.test(block)$conf.int
print(intervalle_de_confiance)

# Calcul de la proportion de blocs supérieurs à 280
proportion <- length(block[block > 280]) / length(block)
print(paste("La proportion de block dont la valeur est supérieure à 280 est de", proportion*100, "%"))

# Calcul de l'intervalle de confiance à 95% pour la proportion
int_confiance_prop <- prop.test(sum(block > 280), length(block))$conf.int
print(int_confiance_prop)
```

## Analyse univariée sur la taille des joueuses 
```{r}
taille <- data$taille
moyenne <- mean(taille)
print(paste("La taille moyenne d'une joueuse est de", round(moyenne, 2)))
variance <- var(taille)
print(paste("La variance de la taille des joueuses est de", round(variance, 2)))

# Analyse gaussienne
par(mfrow=c(1,2))
hist(taille , main="Répartition de la taille des joueuses",xlab="Taille des joueuses (en cm)",prob=T)
curve(dnorm(x, mean(taille), sd(taille)), col=2, add=TRUE, lty=2)
qqnorm(taille)
qqline(taille, col=2)

# Calcul de l'intervalle de confiance à 95% pour la moyenne
intervalle_de_confiance <- t.test(taille)$conf.int
print(intervalle_de_confiance)

# Calcul de la proportion de joueuses mesurant plus de 185 cm
proportion <- length(taille[taille > 185]) / length(taille)
print(paste("La proportion de joueuses mesurant plus de 185 cm est de", round(proportion*100, 2), "%"))

# Calcul de l'intervalle de confiance à 95% pour la proportion
int_confiance_prop <- prop.test(sum(taille > 185), length(taille))$conf.int
print(int_confiance_prop)
```

Dans l'analyse 